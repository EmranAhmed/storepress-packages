import { Meta } from '@storybook/blocks';

<Meta title="Utils/Plugin Example" />

## Install

```shell
npm i @storepress/utils --save
```

## Usage

```js
import { getOptionsFromAttribute } from '@storepress/utils';
```

## Example Plugin `Plugin.js`
```js
/**
 * External dependencies
 */
import { getOptionsFromAttribute } from '@storepress/utils'

function Plugin(element, options) {
    // Default Settings
    const DEFAULTS = {
        size: 20,
    }

    // Collecting settings from html attribute
    const ATTRIBUTE = 'data-slider-settings'

    const handleInput = (event) => {
        window.console.log(event.target.value)
    }

    const addEvents = () => {
        this.$element.querySelectorAll('input').forEach(($el) => {
            $el.addEventListener('input', handleInput)
        })
    }

    const addClass = () => {
       this.$element.querySelectorAll('input').forEach(($el) => {
            $el.classList.add('example-input-class')
        })
    }

    const removeClass = () => {
      this.$element.querySelectorAll('input').forEach(($el) => {
            $el.classList.remove('example-input-class')
      })
    }

    const removeEvents = () => {
        this.$element.querySelectorAll('input').forEach(($el) => {
            $el.removeEventListener('input', handleInput)
        })
    }

    const reset = () => {
        removeEvents()
        removeClass()
    }

    // Expose to public.
    const expose = () => ({
        reset
    })

    // Do what you need and return expose fn.
    const init = () => {
        this.$element = element
        this.settings = {
              ...DEFAULTS,
              ...options,
              ...getOptionsFromAttribute( this.$element, ATTRIBUTE)
            };

        addClass()

        addEvents()

        return expose()
    }

    return init()
}

export { Plugin }
```
## Make Plugin Instance `index.js`
```js

import { createStorePressPlugin } from '@storepress/utils'
import { Plugin } from './Plugin.js'

// Create and setup the plugin
const Slider = createStorePressPlugin({
    selector: '[data-slider-settings]',
    plugin: Plugin,
    namespace: 'slider',
    options: { message: 'Default message' },
})

Slider.setup()

export default Slider
```

## Using the Plugin `script.js`

```javascript
import Slider from './index.js';

document.addEventListener( 'DOMContentLoaded', () => {
    Slider.init();
} );
```

## Method: 01

```js
/**
 * External dependencies
 */
import domReady from '@wordpress/dom-ready';
import {
  getPluginInstance,
  getStorePressPlugin,
} from '@storepress/utils';

domReady(function () {

// Method 1: Get specific plugin instances
const pluginInstances = getPluginInstance('.element', 'slider');

// Method 2: Get via plugin manager
const pluginInstances = getStorePressPlugin('slider').get('.element');

// Method 3: Get all plugin instances
const pluginInstances = getStorePressPlugin('slider').get();

pluginInstances.forEach(instance => {
  instance.handleNext(); // Access plugin exposed functions.
});


const pluginManager = getStorePressPlugin('slider')

// pluginManager.init()
// pluginManager.destroy()
// pluginManager.reload()
})
```
## Method: 02

```js

// Method 1: Get plugin instances.
const pluginInstances = StorePress.Utils.getPluginInstance('.element', 'slider');

// Method 1: Get via plugin manager.
const pluginInstances = StorePress.Utils.getStorePressPlugin('slider').get('.element');

// Method 3: Get all plugin instances
const pluginInstances = StorePress.Utils.getStorePressPlugin('slider').get();


pluginInstances.forEach(instance => {
  instance.handleNext(); // Access plugin exposed functions.
});


const pluginManager = StorePress.Utils.getStorePressPlugin('slider')

// pluginManager.init()
// pluginManager.destroy()
// pluginManager.reload()
```

## Example HTML

```html
<div id="container">
    <div class="slider-wrapper inp" data-slider-settings="{'size': 40}">
        <a>1</a>
        <form>
            <input type="text" placeholder="Location X">
        </form>
    </div>

    <div class="slider-wrapper inp" data-slider-settings--size="30">
        <a>2</a>
        <form>
            <input type="text" placeholder="Location Y">
        </form>
    </div>
</div>
```